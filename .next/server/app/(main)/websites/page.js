(()=>{var e={};e.id=906,e.ids=[906],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},209:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5315:e=>{"use strict";e.exports=require("path")},1265:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,pages:()=>o,routeModule:()=>x,tree:()=>c});var r=s(3003),a=s(4293),l=s(6550),n=s.n(l),i=s(6979),d={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let c=["",{children:["(main)",{children:["websites",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,7394)),"D:\\Code\\Business_Process_Management_Platform\\app\\(main)\\websites\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,634)),"D:\\Code\\Business_Process_Management_Platform\\app\\(main)\\websites\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,8942)),"D:\\Code\\Business_Process_Management_Platform\\app\\(main)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,2075,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,6877)),"D:\\Code\\Business_Process_Management_Platform\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,2075,23)),"next/dist/client/components/not-found-error"]}],o=["D:\\Code\\Business_Process_Management_Platform\\app\\(main)\\websites\\page.tsx"],m={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(main)/websites/page",pathname:"/websites",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},1133:(e,t,s)=>{Promise.resolve().then(s.bind(s,2037))},5303:()=>{},2037:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var r=s(8819),a=s(7266),l=s(5047),n=s(3855),i=s(3685),d=s(1540),c=s(8307),o=s(1137),m=s(7202),x=s(7843);let u={资讯类网站:["宏观资讯","企业资讯","热点资讯"],AI工具:["常用AI工具","对话AI大模型国内","对话AI大模型国外"]},h=e=>Array.from(new Set(e.map(e=>e.category))).sort();function p(){return(0,r.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-current border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]"}),(0,r.jsx)("p",{className:"mt-2 text-gray-500",children:"正在加载网站页面..."})]})})}function b(){(0,l.useRouter)();let e=(0,l.useSearchParams)(),t=e?.get("category"),s=e?.get("subcategory"),[p,b]=(0,a.useState)([]),[g,y]=(0,a.useState)(!0),[j,f]=(0,a.useState)(null),[v,N]=(0,a.useState)(!1),[w,k]=(0,a.useState)({category:"",name:"",description:"",url:""}),[_,P]=(0,a.useState)(null),[C,S]=(0,a.useState)(!1),[Z,M]=(0,a.useState)(null),[q,F]=(0,a.useState)("idle"),[A,E]=(0,a.useState)(""),D=(0,a.useRef)(null),B=()=>{let e=new Blob(["功能名称,功能模块,功能连接节点,产品介绍\n天眼查,企业资讯,https://www.tianyancha.com,企业信息查询平台\n巨量云图,抖音调研工具,https://yuntu.oceanengine.com,数据可视化分析平台"],{type:"text/csv;charset=utf-8;"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.setAttribute("download","常用功能批量导入模板.csv"),document.body.appendChild(s),s.click(),document.body.removeChild(s)},O=(0,a.useMemo)(()=>h(p),[p]),T=async()=>{if(!w.category){alert("请填写功能模块。");return}try{if(_)b(p.map(e=>e.id===_?{...e,...w,id:_}:e));else{let e=await fetch("/api/feishu/websites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:w.name,category:w.category,subcategory:w.subcategory,description:w.description,url:w.url})});if(!e.ok)throw Error("Failed to create website");let t=await e.json();b([...p,t])}let e=w.category||t||u[t||""]?.[0]||O[0]||"";k({category:e,name:"",description:"",url:""}),N(!1),P(null)}catch(e){console.error("Error saving website:",e),alert("保存网站失败，请稍后重试")}},I=e=>{P(e.id),k({...e}),N(!0)},R=async e=>{if(confirm("确定要删除这个网站吗？"))try{b(p.filter(t=>t.id!==e))}catch(e){console.error("Error deleting website:",e),alert("删除网站失败，请稍后重试")}},U=e=>{S(e),!e&&(M(null),F("idle"),E(""),D.current&&(D.current.value=""))},G=async()=>{if(!Z){F("error"),E("请先选择文件");return}F("uploading"),E("正在上传...");try{let e=await fetch("/api/feishu/websites/batch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify([{category:"宏观资讯",name:"数据分析平台",description:"提供详细的数据分析服务",url:"https://example.com/data-analysis"},{category:"企业资讯",name:"企业监控系统",description:"实时监控企业动态",url:"https://example.com/company-monitor"}])});if(!e.ok)throw Error("Failed to process batch upload");let t=await e.json();if(!t.success)throw Error(t.error||"Failed to process batch upload");b(e=>[...e,...t.websites]),F("success"),E(`成功添加 ${t.count} 个网站`),setTimeout(()=>{U(!1)},2e3)}catch(e){console.error("Error processing batch upload:",e),F("error"),E("上传处理失败，请稍后重试")}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.Z,{title:"常用网站"}),(0,r.jsx)("div",{className:"p-6 lg:p-8",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-200 bg-gray-50/80 flex flex-wrap items-center justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("button",{className:"btn btn-primary flex items-center",onClick:()=>{k({category:"",name:"",description:"",url:""}),N(!0),P(null)},children:[(0,r.jsx)(n.Z,{className:"w-4 h-4 mr-1.5"}),"添加网站"]}),(0,r.jsxs)("button",{className:"btn btn-outline flex items-center",onClick:()=>U(!0),children:[(0,r.jsx)(i.Z,{className:"w-4 h-4 mr-1.5"}),"批量添加"]}),(0,r.jsxs)("button",{className:"btn btn-outline flex items-center",disabled:!0,children:[(0,r.jsx)(d.Z,{className:"w-4 h-4 mr-1.5"}),"导出功能"]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(c.Z,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:"搜索功能...",className:"form-input pl-9 py-2 w-64",disabled:!0})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("button",{className:"btn btn-outline flex items-center text-sm",disabled:!0,children:[(0,r.jsx)(o.Z,{className:"w-4 h-4 mr-1.5"}),"筛选"]}),(0,r.jsxs)("button",{className:"btn btn-outline flex items-center text-sm",disabled:!0,children:[(0,r.jsx)(d.Z,{className:"w-4 h-4 mr-1.5"}),"导出"]})]})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"table min-w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"w-16 text-center",children:"#"}),(0,r.jsx)("th",{children:"功能名称"}),(0,r.jsx)("th",{children:"功能模块"}),(0,r.jsx)("th",{children:"功能连接节点"}),(0,r.jsx)("th",{children:"产品介绍"}),(0,r.jsx)("th",{className:"w-20 text-center",children:"操作"})]})}),(0,r.jsx)("tbody",{children:0===p.length?(0,r.jsx)("tr",{children:(0,r.jsxs)("td",{colSpan:6,className:"text-center py-10 text-gray-500",children:[(0,r.jsx)("span",{className:"font-medium",children:"暂无常用网站"}),(0,r.jsx)("p",{className:"text-sm",children:'点击"添加网站"来管理您的常用链接。'})]})}):p.map((e,t)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"text-center text-gray-500",children:t+1}),(0,r.jsx)("td",{className:"font-medium",children:e.name}),(0,r.jsx)("td",{children:e.subcategory||e.category}),(0,r.jsx)("td",{children:(0,r.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-600 break-all",children:e.url})}),(0,r.jsx)("td",{children:e.description}),(0,r.jsx)("td",{children:(0,r.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>I(e),className:"text-xs text-blue-500 hover:text-blue-700",children:"编辑"}),(0,r.jsx)("button",{onClick:()=>R(e.id),className:"text-xs text-red-500 hover:text-red-700",children:"删除"})]})})]},e.id))})]})}),(0,r.jsxs)("div",{className:"p-4 border-t border-gray-200 bg-gray-50/80 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["共 ",p.length," 条记录"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("button",{className:"px-2.5 py-1.5 rounded border border-gray-300 bg-white text-sm text-gray-600 hover:bg-gray-50",disabled:!0,children:"上一页"}),(0,r.jsx)("button",{className:"px-3 py-1.5 rounded border border-blue-500 bg-blue-50 text-sm font-medium text-blue-600",disabled:!0,children:"1"}),(0,r.jsx)("button",{className:"px-2.5 py-1.5 rounded border border-gray-300 bg-white text-sm text-gray-600 hover:bg-gray-50",disabled:!0,children:"下一页"})]})]})]})}),v&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-lg",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:_?"编辑功能":"添加网站"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"siteName",className:"block text-sm font-medium text-gray-700 mb-1",children:["功能名称 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",id:"siteName",value:w.name||"",onChange:e=>k({...w,name:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"例如：天眼查、企业预警通",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"siteDescription",className:"block text-sm font-medium text-gray-700 mb-1",children:["产品介绍 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",id:"siteDescription",value:w.description||"",onChange:e=>k({...w,description:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"简要描述系统的主要功能，例如：企业信息查询、数据分析平台",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"siteUrl",className:"block text-sm font-medium text-gray-700 mb-1",children:["功能连接节点 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",id:"siteUrl",value:w.url||"",onChange:e=>k({...w,url:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"完整访问地址，例如：https://www.tianyancha.com",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"siteCategory",className:"block text-sm font-medium text-gray-700 mb-1",children:["功能模块 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",id:"siteCategory",value:w.category||"",onChange:e=>k({...w,category:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"请输入功能模块",required:!0})]}),s&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"siteSubcategory",className:"block text-sm font-medium text-gray-700 mb-1",children:"子分类"}),(0,r.jsx)("input",{type:"text",id:"siteSubcategory",value:w.subcategory||s,readOnly:!0,className:"w-full p-2 border border-gray-300 rounded-md bg-gray-100"})]})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:()=>{N(!1),k({category:t&&O.includes(t)?t:O[0]||"",name:"",description:"",url:""}),P(null)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"取消"}),(0,r.jsx)("button",{onClick:T,className:"px-4 py-2 text-sm font-medium text-white bg-blue-500 hover:bg-blue-600 rounded-md",children:"保存"})]})]})}),C&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-lg",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"批量添加功能"}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"请上传包含功能信息的CSV或Excel文件。文件应包含以下列：功能名称、功能模块、产品介绍和功能连接节点。"}),(0,r.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[(0,r.jsx)("input",{type:"file",ref:D,onChange:e=>{M(e.target.files?.[0]||null),F("idle"),E("")},accept:".csv,.xlsx,.xls",className:"hidden",id:"batchFileInput"}),(0,r.jsxs)("label",{htmlFor:"batchFileInput",className:"cursor-pointer flex flex-col items-center justify-center",children:[(0,r.jsx)(i.Z,{className:"w-10 h-10 text-gray-400 mb-2"}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:Z?Z.name:"点击选择文件或拖拽文件到此处"}),(0,r.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:"支持 .csv, .xlsx, .xls 格式"})]}),Z&&(0,r.jsx)("button",{onClick:()=>{M(null),D.current&&(D.current.value="")},className:"mt-2 text-sm text-red-500 hover:text-red-700",children:"移除文件"})]}),(0,r.jsx)("div",{className:"mt-3",children:(0,r.jsx)("a",{href:"#",className:"text-sm text-blue-500 hover:text-blue-700",onClick:e=>{e.preventDefault(),B()},children:"下载导入模板"})}),"error"===q&&(0,r.jsxs)("div",{className:"mt-4 p-3 bg-red-50 text-red-700 rounded-md flex items-start",children:[(0,r.jsx)(m.Z,{className:"w-5 h-5 mr-2 mt-0.5 flex-shrink-0"}),(0,r.jsx)("span",{children:A})]}),"success"===q&&(0,r.jsx)("div",{className:"mt-4 p-3 bg-green-50 text-green-700 rounded-md",children:A})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:()=>U(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",disabled:"uploading"===q,children:"取消"}),(0,r.jsx)("button",{onClick:G,disabled:!Z||"uploading"===q,className:`px-4 py-2 text-sm font-medium text-white rounded-md ${Z&&"uploading"!==q?"bg-blue-500 hover:bg-blue-600":"bg-blue-400 cursor-not-allowed"}`,children:"uploading"===q?"上传中...":"上传"})]})]})})]})}function g(){return(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)(p,{}),children:(0,r.jsx)(b,{})})}},7843:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var r=s(8819),a=s(7266),l=s.n(a),n=s(434);let i=({title:e,breadcrumb:t=[]})=>(0,r.jsxs)("div",{className:"p-6 border-b bg-white",children:[t.length>0&&(0,r.jsx)("div",{className:"flex items-center gap-2 text-sm text-gray-500 mb-2",children:t.map((e,t)=>(0,r.jsxs)(l().Fragment,{children:[t>0&&(0,r.jsx)("span",{className:"text-gray-400",children:"/"}),e.path?(0,r.jsx)(n.default,{href:e.path,className:"hover:text-blue-600 transition-colors",children:e.label}):(0,r.jsx)("span",{children:e.label})]},t))}),(0,r.jsx)("h1",{className:"text-2xl font-semibold",children:e})]})},7202:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(6557).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},1540:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(6557).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},1137:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(6557).Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},3855:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(6557).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},8307:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(6557).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},3685:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(6557).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},634:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(9351);function a({children:e}){return(0,r.jsx)("div",{className:"min-h-screen",children:e})}},7394:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{default:()=>e});var a=s(1851);let e=(await (0,a.createProxy)(String.raw`D:\Code\Business_Process_Management_Platform\app\(main)\websites\page.tsx`)).default;r()}catch(e){r(e)}},1)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[267,83,855,284],()=>s(1265));module.exports=r})();