(()=>{var t={};t.id=843,t.ids=[843],t.modules={399:t=>{"use strict";t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:t=>{"use strict";t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9348:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-async-storage.external.js")},412:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5315:t=>{"use strict";t.exports=require("path")},1828:(t,e,s)=>{"use strict";s.r(e),s.d(e,{patchFetch:()=>g,routeModule:()=>y,serverHooks:()=>h,workAsyncStorage:()=>j,workUnitAsyncStorage:()=>m});var r={};s.r(r),s.d(r,{DELETE:()=>p,GET:()=>l,POST:()=>d,PUT:()=>f});var n=s(2412),i=s(4293),o=s(4147),a=s(7856),u=s(7772);let c=(t,e)=>{console.log(`[Assistant API] ${t}`,e?JSON.stringify(e):"")};async function l(){try{c("Fetching all assistant items");let t=await (0,u.Ye)();return c(`Retrieved ${t.length} assistant items`),a.NextResponse.json({items:t})}catch(t){return console.error("Error fetching assistant items:",t),a.NextResponse.json({error:"Failed to fetch assistant items"},{status:500})}}async function d(t){try{let e=await t.json();if(c("Creating assistant item with data:",e),!e.name)return a.NextResponse.json({error:"Name is a required field"},{status:400});let s=`AI${Date.now()}${Math.floor(1e3*Math.random())}`,r={...e,id:s},n=await (0,u.Ye)();return n.push(r),await (0,u.i5)(n),c("Created assistant item:",r),a.NextResponse.json(r)}catch(t){return console.error("Error creating assistant item:",t),a.NextResponse.json({error:"Failed to create assistant item"},{status:500})}}async function f(t){try{let{id:e,...s}=await t.json();if(c(`Updating assistant item ID: ${e}`),!e)return a.NextResponse.json({error:"Assistant item ID is required"},{status:400});let r=await (0,u.Ye)(),n=r.findIndex(t=>t.id===e);if(-1===n)return a.NextResponse.json({error:`Assistant item with ID ${e} not found`},{status:404});let i=r[n],o=Object.assign({},i,s);return r[n]=o,await (0,u.i5)(r),a.NextResponse.json(o)}catch(t){return console.error("Error updating assistant item:",t),a.NextResponse.json({error:"Failed to update assistant item"},{status:500})}}async function p(t){try{let{id:e}=await t.json();if(c(`Deleting assistant item ID: ${e}`),!e)return a.NextResponse.json({error:"Assistant item ID is required"},{status:400});let s=await (0,u.Ye)(),r=s.filter(t=>t.id!==e);if(s.length===r.length)return a.NextResponse.json({error:`Assistant item with ID ${e} not found`},{status:404});return await (0,u.i5)(r),a.NextResponse.json({success:!0})}catch(t){return console.error("Error deleting assistant item:",t),a.NextResponse.json({error:"Failed to delete assistant item"},{status:500})}}let y=new n.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/feishu/assistant/route",pathname:"/api/feishu/assistant",filename:"route",bundlePath:"app/api/feishu/assistant/route"},resolvedPagePath:"D:\\Code\\Business_Process_Management_Platform\\app\\api\\feishu\\assistant\\route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:j,workUnitAsyncStorage:m,serverHooks:h}=y;function g(){return(0,o.patchFetch)({workAsyncStorage:j,workUnitAsyncStorage:m})}},5303:()=>{},7772:(t,e,s)=>{"use strict";s.d(e,{Ye:()=>x,u0:()=>g,Ly:()=>v,ro:()=>N,Vq:()=>R,me:()=>m,i5:()=>S,XG:()=>w,DU:()=>E,pT:()=>F,lb:()=>b,G:()=>h});let r=require("fs");var n=s.n(r),i=s(5315),o=s.n(i);let a=o().join(process.cwd(),"data"),u=o().join(a,"frequentWebsites.json"),c=o().join(a,"businessFlow.json"),l=o().join(a,"documentAssistant.json"),d=o().join(a,"projectDevelopment.json"),f=o().join(a,"resourceLibrary.json"),p=o().join(a,"dashboard.json");async function y(t){try{if(!n().existsSync(t))return console.log(`File not found: ${t}, creating empty file`),n().writeFileSync(t,"[]","utf8"),[];let e=n().readFileSync(t,"utf8");if(!e.trim())return[];return JSON.parse(e)}catch(e){return console.error(`Error reading data from ${t}:`,e),[]}}async function j(t,e){try{n().writeFileSync(t,JSON.stringify(e,null,2),"utf8")}catch(e){throw console.error(`Error writing data to ${t}:`,e),e}}async function m(){return y(u)}async function h(t){return j(u,t)}async function g(){return y(c)}async function w(t){return j(c,t)}async function x(){return y(l)}async function S(t){return j(l,t)}async function N(){return y(d)}async function F(t){return j(d,t)}async function R(){return y(f)}async function b(t){return j(f,t)}async function v(){try{if(!n().existsSync(p)){console.log("Dashboard file not found, creating default");let t={stats:{businessFlows:0,projects:0,resources:0}};return n().writeFileSync(p,JSON.stringify(t,null,2),"utf8"),t}let t=n().readFileSync(p,"utf8");if(!t.trim())return{stats:{businessFlows:0,projects:0,resources:0}};return JSON.parse(t)}catch(t){return console.error("Error reading dashboard data:",t),{stats:{businessFlows:0,projects:0,resources:0}}}}async function E(t){try{n().writeFileSync(p,JSON.stringify(t,null,2),"utf8")}catch(t){throw console.error("Error writing dashboard data:",t),t}}n().existsSync(a)||n().mkdirSync(a,{recursive:!0}),Object.entries({[u]:"[]",[c]:"[]",[l]:"[]",[d]:"[]",[f]:"[]",[p]:"{}"}).forEach(([t,e])=>{n().existsSync(t)||(n().writeFileSync(t,e,"utf8"),console.log(`Initialized ${t}`))})}};var e=require("../../../../webpack-runtime.js");e.C(t);var s=t=>e(e.s=t),r=e.X(0,[267,814],()=>s(1828));module.exports=r})();