(()=>{var e={};e.id=822,e.ids=[822],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5315:e=>{"use strict";e.exports=require("path")},8948:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>h,routeModule:()=>j,serverHooks:()=>w,workAsyncStorage:()=>y,workUnitAsyncStorage:()=>g});var n={};t.r(n),t.d(n,{DELETE:()=>f,GET:()=>l,POST:()=>d,PUT:()=>p});var s=t(2412),o=t(4293),i=t(4147),a=t(7856),c=t(7772);let u=(e,r)=>{console.log(`[Projects API] ${e}`,r?JSON.stringify(r):"")};async function l(){try{u("Fetching all projects");let e=await (0,c.ro)();return u(`Retrieved ${e.length} projects`),a.NextResponse.json({projects:e,timestamp:Date.now()})}catch(e){return console.error("Error fetching projects:",e),a.NextResponse.json({error:"Failed to fetch projects",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function d(e){try{u("Creating new project");let r=await e.json();if(u("Project data received:",r),!r.name||!r.type)return u("Validation failed: Missing required fields"),a.NextResponse.json({error:"Missing required fields",details:"Name and type are required"},{status:400});let t={id:`P${Date.now()}${Math.floor(1e3*Math.random())}`,name:r.name,type:r.type,...r},n=await (0,c.ro)();return n.push(t),await (0,c.pT)(n),u("New project created:",t),a.NextResponse.json(t)}catch(e){return console.error("Error creating project:",e),a.NextResponse.json({error:"Failed to create project",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function p(e){try{u("Updating project");let{id:r,...t}=await e.json();if(u(`Updating project ID: ${r}`,t),!r)return u("Validation failed: Project ID is required"),a.NextResponse.json({error:"Project ID is required"},{status:400});let n=await (0,c.ro)(),s=n.findIndex(e=>e.id===r);if(-1===s)return u(`Project with ID ${r} not found`),a.NextResponse.json({error:`Project with ID ${r} not found`},{status:404});let o={...n[s],...t};return n[s]=o,await (0,c.pT)(n),u("Project updated successfully:",o),a.NextResponse.json(o)}catch(e){return console.error("Error updating project:",e),a.NextResponse.json({error:"Failed to update project",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function f(e){try{u("Deleting project");let{id:r}=await e.json();if(u(`Deleting project ID: ${r}`),!r)return u("Validation failed: Project ID is required"),a.NextResponse.json({error:"Project ID is required"},{status:400});let t=await (0,c.ro)(),n=t.filter(e=>e.id!==r);if(t.length===n.length)return u(`Project with ID ${r} not found`),a.NextResponse.json({error:`Project with ID ${r} not found`},{status:404});return await (0,c.pT)(n),u(`Project deleted: ${r}`),a.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting project:",e),a.NextResponse.json({error:"Failed to delete project",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let j=new s.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/feishu/projects/route",pathname:"/api/feishu/projects",filename:"route",bundlePath:"app/api/feishu/projects/route"},resolvedPagePath:"D:\\Code\\Business_Process_Management_Platform\\app\\api\\feishu\\projects\\route.ts",nextConfigOutput:"",userland:n}),{workAsyncStorage:y,workUnitAsyncStorage:g,serverHooks:w}=j;function h(){return(0,i.patchFetch)({workAsyncStorage:y,workUnitAsyncStorage:g})}},5303:()=>{},7772:(e,r,t)=>{"use strict";t.d(r,{Ye:()=>m,u0:()=>h,Ly:()=>E,ro:()=>N,Vq:()=>D,me:()=>g,i5:()=>P,XG:()=>x,DU:()=>R,pT:()=>S,lb:()=>F,G:()=>w});let n=require("fs");var s=t.n(n),o=t(5315),i=t.n(o);let a=i().join(process.cwd(),"data"),c=i().join(a,"frequentWebsites.json"),u=i().join(a,"businessFlow.json"),l=i().join(a,"documentAssistant.json"),d=i().join(a,"projectDevelopment.json"),p=i().join(a,"resourceLibrary.json"),f=i().join(a,"dashboard.json");async function j(e){try{if(!s().existsSync(e))return console.log(`File not found: ${e}, creating empty file`),s().writeFileSync(e,"[]","utf8"),[];let r=s().readFileSync(e,"utf8");if(!r.trim())return[];return JSON.parse(r)}catch(r){return console.error(`Error reading data from ${e}:`,r),[]}}async function y(e,r){try{s().writeFileSync(e,JSON.stringify(r,null,2),"utf8")}catch(r){throw console.error(`Error writing data to ${e}:`,r),r}}async function g(){return j(c)}async function w(e){return y(c,e)}async function h(){return j(u)}async function x(e){return y(u,e)}async function m(){return j(l)}async function P(e){return y(l,e)}async function N(){return j(d)}async function S(e){return y(d,e)}async function D(){return j(p)}async function F(e){return y(p,e)}async function E(){try{if(!s().existsSync(f)){console.log("Dashboard file not found, creating default");let e={stats:{businessFlows:0,projects:0,resources:0}};return s().writeFileSync(f,JSON.stringify(e,null,2),"utf8"),e}let e=s().readFileSync(f,"utf8");if(!e.trim())return{stats:{businessFlows:0,projects:0,resources:0}};return JSON.parse(e)}catch(e){return console.error("Error reading dashboard data:",e),{stats:{businessFlows:0,projects:0,resources:0}}}}async function R(e){try{s().writeFileSync(f,JSON.stringify(e,null,2),"utf8")}catch(e){throw console.error("Error writing dashboard data:",e),e}}s().existsSync(a)||s().mkdirSync(a,{recursive:!0}),Object.entries({[c]:"[]",[u]:"[]",[l]:"[]",[d]:"[]",[p]:"[]",[f]:"{}"}).forEach(([e,r])=>{s().existsSync(e)||(s().writeFileSync(e,r,"utf8"),console.log(`Initialized ${e}`))})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[267,814],()=>t(8948));module.exports=n})();