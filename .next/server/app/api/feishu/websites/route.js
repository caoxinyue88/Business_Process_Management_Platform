(()=>{var e={};e.id=282,e.ids=[282],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5315:e=>{"use strict";e.exports=require("path")},1253:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>h,routeModule:()=>w,serverHooks:()=>j,workAsyncStorage:()=>y,workUnitAsyncStorage:()=>b});var s={};r.r(s),r.d(s,{DELETE:()=>p,GET:()=>l,POST:()=>d,PUT:()=>f});var n=r(2412),o=r(4293),i=r(4147),a=r(7856),u=r(7772);let c=(e,t)=>{console.log(`[Websites API] ${e}`,t?JSON.stringify(t):"")};async function l(){try{c("Fetching all websites");let e=await (0,u.me)();return c(`Retrieved ${e.length} websites`),a.NextResponse.json({websites:e})}catch(e){return console.error("Error fetching websites:",e),a.NextResponse.json({error:"Failed to fetch websites"},{status:500})}}async function d(e){try{let t=await e.json();if(c("Creating website with data:",t),!t.name||!t.url)return a.NextResponse.json({error:"Name and URL are required fields"},{status:400});let r=`web-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,s={...t,id:r},n=await (0,u.me)();return n.push(s),await (0,u.G)(n),c("Created website:",s),a.NextResponse.json(s)}catch(e){return console.error("Error creating website:",e),a.NextResponse.json({error:"Failed to create website"},{status:500})}}async function f(e){try{let{id:t,...r}=await e.json();if(c(`Updating website ID: ${t}`),!t)return a.NextResponse.json({error:"Website ID is required"},{status:400});let s=await (0,u.me)(),n=s.findIndex(e=>e.id===t);if(-1===n)return a.NextResponse.json({error:`Website with ID ${t} not found`},{status:404});let o=s[n],i=Object.assign({},o,r);return s[n]=i,await (0,u.G)(s),a.NextResponse.json(i)}catch(e){return console.error("Error updating website:",e),a.NextResponse.json({error:"Failed to update website"},{status:500})}}async function p(e){try{let{id:t}=await e.json();if(c(`Deleting website ID: ${t}`),!t)return a.NextResponse.json({error:"Website ID is required"},{status:400});let r=await (0,u.me)(),s=r.filter(e=>e.id!==t);if(r.length===s.length)return a.NextResponse.json({error:`Website with ID ${t} not found`},{status:404});return await (0,u.G)(s),a.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting website:",e),a.NextResponse.json({error:"Failed to delete website"},{status:500})}}let w=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/feishu/websites/route",pathname:"/api/feishu/websites",filename:"route",bundlePath:"app/api/feishu/websites/route"},resolvedPagePath:"D:\\Code\\Business_Process_Management_Platform\\app\\api\\feishu\\websites\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:y,workUnitAsyncStorage:b,serverHooks:j}=w;function h(){return(0,i.patchFetch)({workAsyncStorage:y,workUnitAsyncStorage:b})}},5303:()=>{},7772:(e,t,r)=>{"use strict";r.d(t,{Ye:()=>x,u0:()=>h,Ly:()=>v,ro:()=>S,Vq:()=>F,me:()=>b,i5:()=>m,XG:()=>g,DU:()=>E,pT:()=>N,lb:()=>R,G:()=>j});let s=require("fs");var n=r.n(s),o=r(5315),i=r.n(o);let a=i().join(process.cwd(),"data"),u=i().join(a,"frequentWebsites.json"),c=i().join(a,"businessFlow.json"),l=i().join(a,"documentAssistant.json"),d=i().join(a,"projectDevelopment.json"),f=i().join(a,"resourceLibrary.json"),p=i().join(a,"dashboard.json");async function w(e){try{if(!n().existsSync(e))return console.log(`File not found: ${e}, creating empty file`),n().writeFileSync(e,"[]","utf8"),[];let t=n().readFileSync(e,"utf8");if(!t.trim())return[];return JSON.parse(t)}catch(t){return console.error(`Error reading data from ${e}:`,t),[]}}async function y(e,t){try{n().writeFileSync(e,JSON.stringify(t,null,2),"utf8")}catch(t){throw console.error(`Error writing data to ${e}:`,t),t}}async function b(){return w(u)}async function j(e){return y(u,e)}async function h(){return w(c)}async function g(e){return y(c,e)}async function x(){return w(l)}async function m(e){return y(l,e)}async function S(){return w(d)}async function N(e){return y(d,e)}async function F(){return w(f)}async function R(e){return y(f,e)}async function v(){try{if(!n().existsSync(p)){console.log("Dashboard file not found, creating default");let e={stats:{businessFlows:0,projects:0,resources:0}};return n().writeFileSync(p,JSON.stringify(e,null,2),"utf8"),e}let e=n().readFileSync(p,"utf8");if(!e.trim())return{stats:{businessFlows:0,projects:0,resources:0}};return JSON.parse(e)}catch(e){return console.error("Error reading dashboard data:",e),{stats:{businessFlows:0,projects:0,resources:0}}}}async function E(e){try{n().writeFileSync(p,JSON.stringify(e,null,2),"utf8")}catch(e){throw console.error("Error writing dashboard data:",e),e}}n().existsSync(a)||n().mkdirSync(a,{recursive:!0}),Object.entries({[u]:"[]",[c]:"[]",[l]:"[]",[d]:"[]",[f]:"[]",[p]:"{}"}).forEach(([e,t])=>{n().existsSync(e)||(n().writeFileSync(e,t,"utf8"),console.log(`Initialized ${e}`))})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[267,814],()=>r(1253));module.exports=s})();