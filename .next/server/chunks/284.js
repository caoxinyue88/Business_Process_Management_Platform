exports.id=284,exports.ids=[284],exports.modules={9650:(e,s,t)=>{Promise.resolve().then(t.bind(t,5939))},178:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,2639,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23)),Promise.resolve().then(t.t.bind(t,2816,23))},5179:()=>{},5939:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>C});var a=t(8819),i=t(7266),l=t(434),r=t(5047),n=t(4726),o=t(9513),d=t(6633),c=t(941),h=t(748),x=t(4319),u=t(4909),m=t(1996),f=t(5265),p=t(8919),b=t(8332),g=t(537),j=t(214);(function(){var e=Error("Cannot find module '../../ui/ContextMenu'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '../../modals/BusinessFlowModal'");throw e.code="MODULE_NOT_FOUND",e}();let w=[{id:"bf-Beta",name:"客服机器人Beta",detailPageId:"digitalEmployeeDetailPage_Beta",description:"职责：处理客户常见问题，提供7x24小时支持。",projects:1,resources:1,lastAccessed:"昨天",children:[]}],v=[],y=[];function N(){return(0,a.jsxs)("div",{className:"sidebar text-gray-300 p-4 space-y-6 flex flex-col fixed h-full z-30 shadow-lg animate-pulse",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,a.jsx)("div",{className:"h-8 w-32 bg-gray-600 rounded"})}),(0,a.jsx)("div",{className:"flex-grow space-y-4",children:[...Array(6)].map((e,s)=>(0,a.jsx)("div",{className:"h-8 bg-gray-600 rounded w-full"},s))})]})}function I(){let e=(0,r.usePathname)(),s=(0,r.useSearchParams)(),t=(0,r.useRouter)(),[N,I]=(s?.get("category"),s?.get("subcategory"),(0,i.useState)(!1)),[k,S]=(0,i.useState)(!0),[C,O]=(0,i.useState)(null),[F,P]=(0,i.useState)(w),[$,_]=(0,i.useState)(v),[E,T]=(0,i.useState)(y),[D,Z]=(0,i.useState)(()=>({businessFlow:!0,dataDictionary:!1,websites:!0,assistant:!0})),[z,M]=(0,i.useState)({isVisible:!1,x:0,y:0,targetId:null,targetType:null}),[U,L]=(0,i.useState)({isOpen:!1,mode:"add",parentId:null}),A=async()=>{S(!0),O(null);try{let[e,s,t]=await Promise.allSettled([fetch("/api/feishu/business-flows"),fetch("/api/feishu/websites"),fetch("/api/feishu/assistant")]);if("fulfilled"===e.status&&e.value.ok){let s=await e.value.json();Array.isArray(s)?P(s):(P(w),console.warn("Fetched business flows was not an array:",s))}else console.error("Failed to fetch business flows:","rejected"===e.status?e.reason:"Request not ok"),P(w);if("fulfilled"===s.status&&s.value.ok){let e=await s.value.json();e&&e.websites}if("fulfilled"===t.status&&t.value.ok){let e=await t.value.json();e&&e.assistantItems}}catch(e){console.error("Error fetching data:",e),O("Failed to load data. Using default values."),P(w)}finally{S(!1)}},B=e=>{Z(s=>({...s,[e]:!s[e]}))},V=(e,s,t)=>{e.preventDefault(),M({isVisible:!0,x:e.clientX,y:e.clientY,targetId:s,targetType:t})},Y=()=>{M({isVisible:!1,x:0,y:0,targetId:null,targetType:null})},J=e=>{Y();let s=K(F,e);L({isOpen:!0,mode:"addSub",parentId:e,initialName:"",initialDescription:"",title:`添加子业务流到 "${s?.name||e}"`})},K=(e,s)=>{for(let t of e){if(t.id===s)return t;if(t.children){let e=K(t.children,s);if(e)return e}}},R=async(e,s)=>{let{parentId:t,mode:a}=U;try{let a=await fetch("/api/feishu/business-flows",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,description:s,parentId:t})});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to save business flow")}await a.json(),A(),L({isOpen:!1,mode:"add",parentId:null})}catch(e){console.error("Error saving business flow:",e),alert(`保存业务流失败: ${e instanceof Error?e.message:"请稍后重试"}`)}},q=async e=>{let s=prompt("请输入子网站分类的名称 (placeholder):");s&&console.log("Adding website sub-item:",e,s),Y()},H=async e=>{let s=prompt("请输入子文档助手项的名称 (placeholder):");s&&console.log("Adding assistant sub-item:",e,s),Y()},W=(s,t=0)=>s.map(s=>{let i=`bf_children_${s.id}`,r=!!D[i],h=s.children&&s.children.length>0,x="";if(t>0&&s.parentId){let e=s.id.substring(s.parentId.length+1),t=K(F,s.parentId);for(;t&&t.parentId;)e=`${t.id.substring(t.parentId.length+1)}/${e}`,t=K(F,t.parentId);x=t?`/${t.id.toLowerCase().substring(3)}/${e}`:`/${s.id.toLowerCase().substring(3)}`}else x=`/${s.id.toLowerCase().substring(3)}`;let u=`/business-flow${x}`;return(0,a.jsxs)("li",{className:`${t>0?"ml-4":""}`,children:[(0,a.jsxs)("div",{className:`nav-link nav-item-container flex justify-between items-center py-2 px-3 rounded-md hover:bg-slate-700 hover:text-white text-sm ${e!==u||h?"":"bg-slate-700 text-white"}`,onContextMenu:e=>V(e,s.id,"businessFlow"),children:[(0,a.jsxs)(l.default,{href:h?"#":u,className:"flex-grow flex items-center space-x-2",onClick:e=>{h&&(e.preventDefault(),B(i))},children:[t>0&&(0,a.jsx)(n.Z,{className:"inline mr-1 w-3 h-3 opacity-70"}),(0,a.jsx)(o.Z,{className:"inline mr-1 w-4 h-4 opacity-80"}),(0,a.jsx)("span",{className:"sidebar-text",children:s.name})]}),0===t&&h&&(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),B(i)},className:"p-1",children:r?(0,a.jsx)(d.Z,{className:"w-3 h-3"}):(0,a.jsx)(c.Z,{className:"w-3 h-3"})})]}),h&&r&&(0,a.jsx)("ul",{className:"ml-4 mt-1 space-y-1 border-l border-slate-600 pl-3",children:W(s.children,t+1)})]},s.id)});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("nav",{className:`sidebar text-gray-300 p-4 space-y-6 flex flex-col fixed h-full z-30 shadow-lg ${N?"sidebar-collapsed":""}`,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(o.Z,{className:"text-sky-400 w-8 h-8"}),(0,a.jsx)("h1",{className:"text-lg font-semibold text-white sidebar-logo-text",children:"业务流程管理平台"})]}),(0,a.jsx)("button",{onClick:()=>{I(!N)},className:"p-1.5 rounded-md hover:bg-slate-700 text-gray-400 hover:text-white",children:(0,a.jsx)(h.Z,{className:"w-5 h-5"})})]}),k&&(0,a.jsxs)("div",{className:"text-center py-4",children:[(0,a.jsx)("div",{className:"animate-pulse flex justify-center",children:(0,a.jsx)("div",{className:"bg-gray-500 rounded-full h-3 w-24"})}),(0,a.jsx)("p",{className:"text-xs mt-2 text-gray-400",children:"正在从飞书加载数据..."})]}),C&&(0,a.jsx)("div",{className:"text-xs text-red-400 p-2 mb-2 bg-red-900/20 rounded-md",children:C}),(0,a.jsxs)("ul",{className:"space-y-1.5 flex-grow overflow-y-auto pr-1",children:[(0,a.jsx)("li",{children:(0,a.jsxs)(l.default,{href:"/dashboard",className:`nav-link nav-item-container flex items-center space-x-3 py-2.5 px-3 rounded-lg hover:bg-slate-700 hover:text-white ${"/dashboard"===e?"bg-sky-600 text-white":""}`,children:[(0,a.jsx)(x.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"sidebar-text font-medium",children:"仪表盘"})]})}),(0,a.jsx)("li",{children:(0,a.jsxs)("div",{className:"nav-section",children:[(0,a.jsxs)("div",{className:"nav-section-toggle nav-item-container w-full flex items-center justify-between py-2.5 px-3 rounded-lg hover:bg-slate-700 hover:text-white cursor-pointer",onClick:()=>B("businessFlow"),children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(u.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"sidebar-text font-medium",children:"业务流"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("button",{className:"p-1 hover:bg-slate-600 rounded text-gray-400 hover:text-white",onClick:e=>{e.stopPropagation();let s=F.length>0?F[0].id:null,a=s?`/business-flow/process?businessFlowId=${s}&defaultType=project`:"/business-flow/process?defaultType=project";t.push(a)},title:"添加流程",children:(0,a.jsx)(m.Z,{className:"w-4 h-4"})}),(0,a.jsx)("span",{onClick:e=>e.stopPropagation(),children:D.businessFlow?(0,a.jsx)(d.Z,{className:"sidebar-text w-4 h-4"}):(0,a.jsx)(c.Z,{className:"sidebar-text w-4 h-4"})})]})]}),(0,a.jsx)("ul",{className:`nav-section-content ml-3 mt-1 space-y-1 border-l-2 border-slate-700 pl-4 ${D.businessFlow?"":"hidden"}`,children:W(F)})]})}),(0,a.jsx)("li",{children:(0,a.jsxs)(l.default,{href:"/project",className:`nav-link nav-item-container flex items-center space-x-3 py-2.5 px-3 rounded-lg hover:bg-slate-700 hover:text-white ${"/project"===e?"bg-sky-600 text-white":""}`,children:[(0,a.jsx)(f.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"sidebar-text font-medium",children:"项目开发/数字员工"})]})}),(0,a.jsx)("li",{children:(0,a.jsxs)(l.default,{href:"/resource",className:`nav-link nav-item-container flex items-center space-x-3 py-2.5 px-3 rounded-lg hover:bg-slate-700 hover:text-white ${"/resource"===e?"bg-sky-600 text-white":""}`,children:[(0,a.jsx)(p.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"sidebar-text font-medium",children:"资源库"})]})}),(0,a.jsx)("li",{children:(0,a.jsxs)(l.default,{href:"/websites",className:`nav-link nav-item-container flex items-center space-x-3 py-2.5 px-3 rounded-lg hover:bg-slate-700 hover:text-white ${"/websites"===e?"bg-sky-600 text-white":""}`,children:[(0,a.jsx)(b.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"sidebar-text font-medium",children:"常用网站"})]})}),(0,a.jsx)("li",{children:(0,a.jsxs)(l.default,{href:"/assistant",className:`nav-link nav-item-container flex items-center space-x-3 py-2.5 px-3 rounded-lg hover:bg-slate-700 hover:text-white ${"/assistant"===e||e.startsWith("/assistant?")?"bg-sky-600 text-white":""}`,children:[(0,a.jsx)(g.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"sidebar-text font-medium",children:"文档助手"})]})})]}),(0,a.jsxs)("div",{className:"pt-4 border-t border-slate-700 sidebar-text",children:[(0,a.jsxs)(l.default,{href:"/settings",className:"flex items-center space-x-3 py-2.5 px-3 rounded-lg hover:bg-slate-700 hover:text-white",children:[(0,a.jsx)(j.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"设置"})]}),(0,a.jsxs)(l.default,{href:"/profile",className:"flex items-center space-x-3 py-2.5 px-3 rounded-lg hover:bg-slate-700 hover:text-white",children:[(0,a.jsx)("img",{src:"https://placehold.co/36x36/475569/E2E8F0?text=U",alt:"User Avatar",className:"w-9 h-9 rounded-full border-2 border-slate-600"}),(0,a.jsx)("span",{children:"用户名称"})]})]})]}),(0,a.jsx)(Object(function(){var e=Error("Cannot find module '../../modals/BusinessFlowModal'");throw e.code="MODULE_NOT_FOUND",e}()),{isOpen:U.isOpen,onClose:()=>L({isOpen:!1,mode:"add",parentId:null}),onSave:R,initialName:U.initialName,initialDescription:U.initialDescription,title:U.title||("add"===U.mode?"添加新业务流":"编辑业务流")}),z.isVisible&&(0,a.jsx)(Object(function(){var e=Error("Cannot find module '../../ui/ContextMenu'");throw e.code="MODULE_NOT_FOUND",e}()),{x:z.x,y:z.y,items:(()=>{if(!z.targetId||!z.targetType)return[];switch(z.targetType){case"businessFlow":return[{label:"添加子业务流",action:()=>J(z.targetId)}];case"websiteCategory":return[{label:"添加子网站分类",action:()=>q(z.targetId)}];case"assistantCategory":return[{label:"添加子文档助手项",action:()=>H(z.targetId)}];default:return[]}})(),onClose:Y,isVisible:z.isVisible})]})}function k(){return(0,a.jsx)(i.Suspense,{fallback:(0,a.jsx)(N,{}),children:(0,a.jsx)(I,{})})}function S(){return(0,a.jsx)(k,{})}function C({children:e}){let[s,t]=(0,i.useState)(!1);return(0,a.jsxs)("div",{className:"flex h-screen overflow-hidden",children:[(0,a.jsx)(S,{}),(0,a.jsx)("div",{className:"main-content flex-1 ml-[260px] overflow-y-auto",children:e})]})}},8942:(e,s,t)=>{"use strict";t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>e});var i=t(1851);let e=(await (0,i.createProxy)(String.raw`D:\Code\Business_Process_Management_Platform\app\(main)\layout.tsx`)).default;a()}catch(e){a(e)}},1)},6877:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n,metadata:()=>r});var a=t(9351),i=t(6921),l=t.n(i);t(7272);let r={title:"业务流程管理平台",description:"用于创建、管理和监控企业业务流程的综合性平台"};function n({children:e}){return(0,a.jsx)("html",{lang:"zh-CN",className:l().variable,children:(0,a.jsxs)("body",{className:"bg-gray-100 antialiased",children:[(0,a.jsx)("script",{dangerouslySetInnerHTML:{__html:`
          // Initialize localStorage if needed
          (function() {
            const INIT_KEY = 'storageInitialized';
            const keys = ['websites', 'assistantItems', 'projects', 'resources', 'businessFlows'];
            
            // Check if localStorage is already initialized
            const isInitialized = localStorage.getItem(INIT_KEY);
            if (isInitialized === 'true') return;
            
            // Initialize each feature with empty arrays
            for (const key of keys) {
              if (!localStorage.getItem(key)) {
                localStorage.setItem(key, JSON.stringify([]));
              }
            }
            
            // Initialize dashboard
            if (!localStorage.getItem('dashboard')) {
              localStorage.setItem('dashboard', JSON.stringify({
                stats: {
                  businessFlows: 0,
                  projects: 0,
                  resources: 0
                }
              }));
            }
            
            // Mark storage as initialized
            localStorage.setItem(INIT_KEY, 'true');
            console.log('LocalStorage manually initialized');
          })();
        `}}),e]})})}},7272:()=>{}};