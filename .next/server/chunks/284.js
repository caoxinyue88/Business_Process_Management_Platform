exports.id=284,exports.ids=[284],exports.modules={9650:(e,s,t)=>{Promise.resolve().then(t.bind(t,8603))},178:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,2639,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23)),Promise.resolve().then(t.t.bind(t,2816,23))},5179:()=>{},8603:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>H});var a=t(8819),i=t(7266),l=t(434),r=t(5047),n=t(4726),o=t(9513),d=t(6633),c=t(941),u=t(748),x=t(4319),m=t(4909),f=t(1996),h=t(5265),p=t(8919),g=t(8332),b=t(537),j=t(214);function y({x:e,y:s,items:t,onClose:l,isVisible:r}){let n=(0,i.useRef)(null);return r?(0,a.jsx)("div",{ref:n,className:"fixed bg-white border border-gray-300 rounded-md shadow-lg z-50 text-sm",style:{top:s,left:e},onClick:e=>e.stopPropagation(),children:(0,a.jsx)("ul",{className:"py-1",children:t.map((e,s)=>(0,a.jsx)("li",{children:(0,a.jsx)("button",{onClick:()=>{e.action(),l()},className:"w-full text-left px-4 py-2 hover:bg-gray-100 text-gray-700",children:e.label})},s))})}):null}var v=t(4214),w=t(9360),N=t(7863);let k=(0,w.j)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),I=i.forwardRef(({className:e,variant:s,size:t,asChild:i=!1,...l},r)=>{let n=i?v.g7:"button";return(0,a.jsx)(n,{className:(0,N.cn)(k({variant:s,size:t,className:e})),ref:r,...l})});I.displayName="Button";let S=i.forwardRef(({className:e,type:s,...t},i)=>(0,a.jsx)("input",{type:s,className:(0,N.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:i,...t}));S.displayName="Input";let C=i.forwardRef(({className:e,...s},t)=>(0,a.jsx)("textarea",{className:(0,N.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:t,...s}));C.displayName="Textarea";var P=t(4478);let z=(0,w.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),$=i.forwardRef(({className:e,...s},t)=>(0,a.jsx)(P.f,{ref:t,className:(0,N.cn)(z(),e),...s}));$.displayName=P.f.displayName;var F=t(8958),Z=t(4019);let T=F.fC;F.xz;let _=({...e})=>(0,a.jsx)(F.h_,{...e});_.displayName=F.h_.displayName;let D=i.forwardRef(({className:e,...s},t)=>(0,a.jsx)(F.aV,{ref:t,className:(0,N.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s}));D.displayName=F.aV.displayName;let O=i.forwardRef(({className:e,children:s,...t},i)=>(0,a.jsxs)(_,{children:[(0,a.jsx)(D,{}),(0,a.jsxs)(F.VY,{ref:i,className:(0,N.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg md:w-full",e),...t,children:[s,(0,a.jsxs)(F.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(Z.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));O.displayName=F.VY.displayName;let R=({className:e,...s})=>(0,a.jsx)("div",{className:(0,N.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...s});R.displayName="DialogHeader";let V=({className:e,...s})=>(0,a.jsx)("div",{className:(0,N.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...s});V.displayName="DialogFooter";let E=i.forwardRef(({className:e,...s},t)=>(0,a.jsx)(F.Dx,{ref:t,className:(0,N.cn)("text-lg font-semibold leading-none tracking-tight",e),...s}));function A({isOpen:e,onClose:s,onSave:t,initialName:l="",initialDescription:r="",title:n="业务流"}){let[o,d]=(0,i.useState)(l),[c,u]=(0,i.useState)(r);return(0,a.jsx)(T,{open:e,onOpenChange:e=>{e||s()},children:(0,a.jsxs)(O,{className:"sm:max-w-[425px]",children:[(0,a.jsx)(R,{children:(0,a.jsx)(E,{children:n})}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsxs)($,{htmlFor:"flow-name",className:"text-right",children:["名称 ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(S,{id:"flow-name",value:o,onChange:e=>d(e.target.value),className:"col-span-3",placeholder:"请输入业务流名称"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)($,{htmlFor:"flow-description",className:"text-right",children:"描述"}),(0,a.jsx)(C,{id:"flow-description",value:c,onChange:e=>u(e.target.value),className:"col-span-3",placeholder:"请输入业务流描述 (可选)",rows:3})]})]}),(0,a.jsxs)(V,{children:[(0,a.jsx)(I,{variant:"outline",onClick:s,children:"取消"}),(0,a.jsx)(I,{onClick:()=>{if(!o.trim()){alert("业务流名称不能为空");return}t(o.trim(),c.trim()),s()},children:"保存"})]})]})})}E.displayName=F.Dx.displayName,i.forwardRef(({className:e,...s},t)=>(0,a.jsx)(F.dk,{ref:t,className:(0,N.cn)("text-sm text-muted-foreground",e),...s})).displayName=F.dk.displayName;let Y=[{id:"bf-Beta",name:"客服机器人Beta",detailPageId:"digitalEmployeeDetailPage_Beta",description:"职责：处理客户常见问题，提供7x24小时支持。",projects:1,resources:1,lastAccessed:"昨天",children:[]}],B=[],L=[];function M(){return(0,a.jsxs)("div",{className:"sidebar text-gray-300 p-4 space-y-6 flex flex-col fixed h-full z-30 shadow-lg animate-pulse",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,a.jsx)("div",{className:"h-8 w-32 bg-gray-600 rounded"})}),(0,a.jsx)("div",{className:"flex-grow space-y-4",children:[...Array(6)].map((e,s)=>(0,a.jsx)("div",{className:"h-8 bg-gray-600 rounded w-full"},s))})]})}function J(){let e=(0,r.usePathname)(),s=(0,r.useSearchParams)(),t=(0,r.useRouter)(),[v,w]=(s?.get("category"),s?.get("subcategory"),(0,i.useState)(!1)),[N,k]=(0,i.useState)(!0),[I,S]=(0,i.useState)(null),[C,P]=(0,i.useState)(Y),[z,$]=(0,i.useState)(B),[F,Z]=(0,i.useState)(L),[T,_]=(0,i.useState)(()=>({businessFlow:!0,dataDictionary:!1,websites:!0,assistant:!0})),[D,O]=(0,i.useState)({isVisible:!1,x:0,y:0,targetId:null,targetType:null}),[R,V]=(0,i.useState)({isOpen:!1,mode:"add",parentId:null}),E=async()=>{k(!0),S(null);try{let[e,s,t]=await Promise.allSettled([fetch("/api/feishu/business-flows"),fetch("/api/feishu/websites"),fetch("/api/feishu/assistant")]);if("fulfilled"===e.status&&e.value.ok){let s=await e.value.json();Array.isArray(s)?P(s):(P(Y),console.warn("Fetched business flows was not an array:",s))}else console.error("Failed to fetch business flows:","rejected"===e.status?e.reason:"Request not ok"),P(Y);if("fulfilled"===s.status&&s.value.ok){let e=await s.value.json();e&&e.websites}if("fulfilled"===t.status&&t.value.ok){let e=await t.value.json();e&&e.assistantItems}}catch(e){console.error("Error fetching data:",e),S("Failed to load data. Using default values."),P(Y)}finally{k(!1)}},M=e=>{_(s=>({...s,[e]:!s[e]}))},J=(e,s,t)=>{e.preventDefault(),O({isVisible:!0,x:e.clientX,y:e.clientY,targetId:s,targetType:t})},K=()=>{O({isVisible:!1,x:0,y:0,targetId:null,targetType:null})},U=e=>{K();let s=H(C,e);V({isOpen:!0,mode:"addSub",parentId:e,initialName:"",initialDescription:"",title:`添加子业务流到 "${s?.name||e}"`})},H=(e,s)=>{for(let t of e){if(t.id===s)return t;if(t.children){let e=H(t.children,s);if(e)return e}}},W=async(e,s)=>{let{parentId:t,mode:a}=R;try{let a=await fetch("/api/feishu/business-flows",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,description:s,parentId:t})});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to save business flow")}await a.json(),E(),V({isOpen:!1,mode:"add",parentId:null})}catch(e){console.error("Error saving business flow:",e),alert(`保存业务流失败: ${e instanceof Error?e.message:"请稍后重试"}`)}},q=async e=>{let s=prompt("请输入子网站分类的名称 (placeholder):");s&&console.log("Adding website sub-item:",e,s),K()},X=async e=>{let s=prompt("请输入子文档助手项的名称 (placeholder):");s&&console.log("Adding assistant sub-item:",e,s),K()},G=(s,t=0)=>s.map(s=>{let i=`bf_children_${s.id}`,r=!!T[i],u=s.children&&s.children.length>0,x="";if(t>0&&s.parentId){let e=s.id.substring(s.parentId.length+1),t=H(C,s.parentId);for(;t&&t.parentId;)e=`${t.id.substring(t.parentId.length+1)}/${e}`,t=H(C,t.parentId);x=t?`/${t.id.toLowerCase().substring(3)}/${e}`:`/${s.id.toLowerCase().substring(3)}`}else x=`/${s.id.toLowerCase().substring(3)}`;let m=`/business-flow${x}`;return(0,a.jsxs)("li",{className:`${t>0?"ml-4":""}`,children:[(0,a.jsxs)("div",{className:`nav-link nav-item-container flex justify-between items-center py-2 px-3 rounded-md hover:bg-slate-700 hover:text-white text-sm ${e!==m||u?"":"bg-slate-700 text-white"}`,onContextMenu:e=>J(e,s.id,"businessFlow"),children:[(0,a.jsxs)(l.default,{href:u?"#":m,className:"flex-grow flex items-center space-x-2",onClick:e=>{u&&(e.preventDefault(),M(i))},children:[t>0&&(0,a.jsx)(n.Z,{className:"inline mr-1 w-3 h-3 opacity-70"}),(0,a.jsx)(o.Z,{className:"inline mr-1 w-4 h-4 opacity-80"}),(0,a.jsx)("span",{className:"sidebar-text",children:s.name})]}),0===t&&u&&(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),M(i)},className:"p-1",children:r?(0,a.jsx)(d.Z,{className:"w-3 h-3"}):(0,a.jsx)(c.Z,{className:"w-3 h-3"})})]}),u&&r&&(0,a.jsx)("ul",{className:"ml-4 mt-1 space-y-1 border-l border-slate-600 pl-3",children:G(s.children,t+1)})]},s.id)});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("nav",{className:`sidebar text-gray-300 p-4 space-y-6 flex flex-col fixed h-full z-30 shadow-lg ${v?"sidebar-collapsed":""}`,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(o.Z,{className:"text-sky-400 w-8 h-8"}),(0,a.jsx)("h1",{className:"text-lg font-semibold text-white sidebar-logo-text",children:"业务流程管理平台"})]}),(0,a.jsx)("button",{onClick:()=>{w(!v)},className:"p-1.5 rounded-md hover:bg-slate-700 text-gray-400 hover:text-white",children:(0,a.jsx)(u.Z,{className:"w-5 h-5"})})]}),N&&(0,a.jsxs)("div",{className:"text-center py-4",children:[(0,a.jsx)("div",{className:"animate-pulse flex justify-center",children:(0,a.jsx)("div",{className:"bg-gray-500 rounded-full h-3 w-24"})}),(0,a.jsx)("p",{className:"text-xs mt-2 text-gray-400",children:"正在从飞书加载数据..."})]}),I&&(0,a.jsx)("div",{className:"text-xs text-red-400 p-2 mb-2 bg-red-900/20 rounded-md",children:I}),(0,a.jsxs)("ul",{className:"space-y-1.5 flex-grow overflow-y-auto pr-1",children:[(0,a.jsx)("li",{children:(0,a.jsxs)(l.default,{href:"/dashboard",className:`nav-link nav-item-container flex items-center space-x-3 py-2.5 px-3 rounded-lg hover:bg-slate-700 hover:text-white ${"/dashboard"===e?"bg-sky-600 text-white":""}`,children:[(0,a.jsx)(x.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"sidebar-text font-medium",children:"仪表盘"})]})}),(0,a.jsx)("li",{children:(0,a.jsxs)("div",{className:"nav-section",children:[(0,a.jsxs)("div",{className:"nav-section-toggle nav-item-container w-full flex items-center justify-between py-2.5 px-3 rounded-lg hover:bg-slate-700 hover:text-white cursor-pointer",onClick:()=>M("businessFlow"),children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(m.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"sidebar-text font-medium",children:"业务流"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("button",{className:"p-1 hover:bg-slate-600 rounded text-gray-400 hover:text-white",onClick:e=>{e.stopPropagation();let s=C.length>0?C[0].id:null,a=s?`/business-flow/process?businessFlowId=${s}&defaultType=project`:"/business-flow/process?defaultType=project";t.push(a)},title:"添加流程",children:(0,a.jsx)(f.Z,{className:"w-4 h-4"})}),(0,a.jsx)("span",{onClick:e=>e.stopPropagation(),children:T.businessFlow?(0,a.jsx)(d.Z,{className:"sidebar-text w-4 h-4"}):(0,a.jsx)(c.Z,{className:"sidebar-text w-4 h-4"})})]})]}),(0,a.jsx)("ul",{className:`nav-section-content ml-3 mt-1 space-y-1 border-l-2 border-slate-700 pl-4 ${T.businessFlow?"":"hidden"}`,children:G(C)})]})}),(0,a.jsx)("li",{children:(0,a.jsxs)(l.default,{href:"/project",className:`nav-link nav-item-container flex items-center space-x-3 py-2.5 px-3 rounded-lg hover:bg-slate-700 hover:text-white ${"/project"===e?"bg-sky-600 text-white":""}`,children:[(0,a.jsx)(h.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"sidebar-text font-medium",children:"项目开发/数字员工"})]})}),(0,a.jsx)("li",{children:(0,a.jsxs)(l.default,{href:"/resource",className:`nav-link nav-item-container flex items-center space-x-3 py-2.5 px-3 rounded-lg hover:bg-slate-700 hover:text-white ${"/resource"===e?"bg-sky-600 text-white":""}`,children:[(0,a.jsx)(p.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"sidebar-text font-medium",children:"资源库"})]})}),(0,a.jsx)("li",{children:(0,a.jsxs)(l.default,{href:"/websites",className:`nav-link nav-item-container flex items-center space-x-3 py-2.5 px-3 rounded-lg hover:bg-slate-700 hover:text-white ${"/websites"===e?"bg-sky-600 text-white":""}`,children:[(0,a.jsx)(g.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"sidebar-text font-medium",children:"常用网站"})]})}),(0,a.jsx)("li",{children:(0,a.jsxs)(l.default,{href:"/assistant",className:`nav-link nav-item-container flex items-center space-x-3 py-2.5 px-3 rounded-lg hover:bg-slate-700 hover:text-white ${"/assistant"===e||e.startsWith("/assistant?")?"bg-sky-600 text-white":""}`,children:[(0,a.jsx)(b.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"sidebar-text font-medium",children:"文档助手"})]})})]}),(0,a.jsxs)("div",{className:"pt-4 border-t border-slate-700 sidebar-text",children:[(0,a.jsxs)(l.default,{href:"/settings",className:"flex items-center space-x-3 py-2.5 px-3 rounded-lg hover:bg-slate-700 hover:text-white",children:[(0,a.jsx)(j.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"设置"})]}),(0,a.jsxs)(l.default,{href:"/profile",className:"flex items-center space-x-3 py-2.5 px-3 rounded-lg hover:bg-slate-700 hover:text-white",children:[(0,a.jsx)("img",{src:"https://placehold.co/36x36/475569/E2E8F0?text=U",alt:"User Avatar",className:"w-9 h-9 rounded-full border-2 border-slate-600"}),(0,a.jsx)("span",{children:"用户名称"})]})]})]}),(0,a.jsx)(A,{isOpen:R.isOpen,onClose:()=>V({isOpen:!1,mode:"add",parentId:null}),onSave:W,initialName:R.initialName,initialDescription:R.initialDescription,title:R.title||("add"===R.mode?"添加新业务流":"编辑业务流")}),D.isVisible&&(0,a.jsx)(y,{x:D.x,y:D.y,items:(()=>{if(!D.targetId||!D.targetType)return[];switch(D.targetType){case"businessFlow":return[{label:"添加子业务流",action:()=>U(D.targetId)}];case"websiteCategory":return[{label:"添加子网站分类",action:()=>q(D.targetId)}];case"assistantCategory":return[{label:"添加子文档助手项",action:()=>X(D.targetId)}];default:return[]}})(),onClose:K,isVisible:D.isVisible})]})}function K(){return(0,a.jsx)(i.Suspense,{fallback:(0,a.jsx)(M,{}),children:(0,a.jsx)(J,{})})}function U(){return(0,a.jsx)(K,{})}function H({children:e}){let[s,t]=(0,i.useState)(!1);return(0,a.jsxs)("div",{className:"flex h-screen overflow-hidden",children:[(0,a.jsx)(U,{}),(0,a.jsx)("div",{className:"main-content flex-1 ml-[260px] overflow-y-auto",children:e})]})}},7863:(e,s,t)=>{"use strict";t.d(s,{cn:()=>l});var a=t(1135),i=t(1009);function l(...e){return(0,i.m6)((0,a.W)(e))}},8942:(e,s,t)=>{"use strict";t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>e});var i=t(1851);let e=(await (0,i.createProxy)(String.raw`D:\Code\Business_Process_Management_Platform\app\(main)\layout.tsx`)).default;a()}catch(e){a(e)}},1)},6877:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n,metadata:()=>r});var a=t(9351),i=t(6921),l=t.n(i);t(7272);let r={title:"业务流程管理平台",description:"用于创建、管理和监控企业业务流程的综合性平台"};function n({children:e}){return(0,a.jsx)("html",{lang:"zh-CN",className:l().variable,children:(0,a.jsxs)("body",{className:"bg-gray-100 antialiased",children:[(0,a.jsx)("script",{dangerouslySetInnerHTML:{__html:`
          // Initialize localStorage if needed
          (function() {
            const INIT_KEY = 'storageInitialized';
            const keys = ['websites', 'assistantItems', 'projects', 'resources', 'businessFlows'];
            
            // Check if localStorage is already initialized
            const isInitialized = localStorage.getItem(INIT_KEY);
            if (isInitialized === 'true') return;
            
            // Initialize each feature with empty arrays
            for (const key of keys) {
              if (!localStorage.getItem(key)) {
                localStorage.setItem(key, JSON.stringify([]));
              }
            }
            
            // Initialize dashboard
            if (!localStorage.getItem('dashboard')) {
              localStorage.setItem('dashboard', JSON.stringify({
                stats: {
                  businessFlows: 0,
                  projects: 0,
                  resources: 0
                }
              }));
            }
            
            // Mark storage as initialized
            localStorage.setItem(INIT_KEY, 'true');
            console.log('LocalStorage manually initialized');
          })();
        `}}),e]})})}},7272:()=>{}};